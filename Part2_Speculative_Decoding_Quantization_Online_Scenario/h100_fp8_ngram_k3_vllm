#VLLM Server
VLLM_ATTENTION_BACKEND=FLASH_ATTN vllm serve "Qwen/Qwen3-8B-FP8" --kv-cache-dtype fp8 --max-model-len 8192 --tensor-parallel-size 1 --gpu-memory-utilization 0.9 --seed 42 --speculative-config '{"method": "ngram","num_speculative_tokens": 3, "prompt_lookup_max": 3}' &> serve_fp8_num3.log &


# Guidellm Client (Prefill-heavy)
guidellm benchmark --target http://localhost:8000 --model "Qwen/Qwen3-8B-FP8" \
--data 'prompt_tokens=2048,output_tokens=128' \
--data-samples 300 \
--rate-type sweep \
--warmup 0.01 \
--cooldown 0.01

ℹ Request Latency Statistics (Completed Requests)
|=============|=========|========|========|========|======|======|======|======|
| Benchmark   | Request Latency || TTFT           || ITL        || TPOT       ||
| Strategy    | Sec             || ms             || ms         || ms         ||
|             | Mdn     | p95    | Mdn    | p95    | Mdn  | p95  | Mdn  | p95  |
|-------------|---------|--------|--------|--------|------|------|------|------|
| synchronous | 1.0     | 1.0    | 30.7   | 31.7   | 7.5  | 7.9  | 7.7  | 8.1  |
| throughput  | 7.2     | 7.6    | 3938.4 | 4067.2 | 25.6 | 28.4 | 56.0 | 59.1 |
| constant    | 7.3     | 7.7    | 3958.8 | 4147.6 | 25.9 | 28.5 | 56.7 | 60.1 |
| constant    | 1.2     | 1.3    | 37.2   | 42.7   | 9.3  | 9.6  | 9.5  | 9.9  |
| constant    | 1.4     | 1.5    | 40.0   | 45.5   | 10.8 | 11.3 | 11.0 | 11.6 |
| constant    | 7.4     | 7.7    | 4034.5 | 4146.7 | 26.2 | 29.0 | 57.5 | 60.4 |
| constant    | 7.3     | 7.8    | 4159.7 | 4254.0 | 25.3 | 28.3 | 57.4 | 60.6 |
| constant    | 1.7     | 1.7    | 51.6   | 53.3   | 12.7 | 13.3 | 12.9 | 13.6 |
| constant    | 7.3     | 7.6    | 3958.5 | 4059.7 | 26.1 | 28.6 | 56.8 | 59.4 |
| constant    | 2.0     | 2.2    | 49.2   | 59.9   | 15.2 | 16.7 | 15.5 | 16.9 |
|=============|=========|========|========|========|======|======|======|======|


ℹ Server Throughput Statistics
|=============|======|======|=======|=======|=========|==========|========|========|========|=========|
| Benchmark   | Requests                 |||| Input Tokens      || Output Tokens  || Total Tokens    ||
| Strategy    | Per Sec    || Concurrency  || Per Sec           || Per Sec        || Per Sec         ||
|             | Mdn  | Mean | Mdn   | Mean  | Mdn     | Mean     | Mdn    | Mean   | Mdn    | Mean    |
|-------------|------|------|-------|-------|---------|----------|--------|--------|--------|---------|
| synchronous | 1.0  | 1.0  | 1.0   | 1.0   | 2096.4  | 2108.8   | 131.1  | 130.8  | 132.3  | 2232.5  |
| throughput  | 17.9 | 35.5 | 225.0 | 229.6 | 78014.5 | 149917.3 | 3135.5 | 5073.8 | 3327.6 | 86571.8 |
| constant    | 16.3 | 34.0 | 223.0 | 227.9 | 74667.4 | 147688.8 | 2984.2 | 4995.7 | 3149.0 | 85238.6 |
| constant    | 8.7  | 9.6  | 12.0  | 11.5  | 19808.1 | 19805.5  | 928.7  | 1183.0 | 934.0  | 20184.3 |
| constant    | 12.3 | 14.1 | 19.0  | 19.2  | 28779.4 | 28783.2  | 1273.8 | 1670.1 | 1284.7 | 28496.9 |
| constant    | 16.8 | 34.0 | 228.0 | 232.5 | 75913.7 | 153116.5 | 3196.1 | 5062.5 | 3282.3 | 86378.2 |
| constant    | 17.0 | 33.5 | 225.0 | 229.6 | 73282.9 | 145649.3 | 3158.1 | 4992.2 | 3255.3 | 85179.8 |
| constant    | 22.0 | 26.6 | 44.0  | 43.8  | 55050.8 | 54678.7  | 2201.7 | 2997.3 | 2229.7 | 51141.1 |
| constant    | 16.8 | 35.2 | 224.0 | 231.4 | 77201.5 | 152522.1 | 3268.6 | 5085.9 | 3385.2 | 86778.3 |
| constant    | 28.1 | 34.7 | 71.0  | 67.8  | 71969.2 | 72969.9  | 2581.6 | 3779.5 | 2625.8 | 64487.9 |
|=============|======|======|=======|=======|=========|==========|========|========|========|=========|


# Guidellm Client (Balanced)
guidellm benchmark --target http://localhost:8000 --model "Qwen/Qwen3-8B-FP8" \
--data 'prompt_tokens=1024,output_tokens=1024' \
--data-samples 300 \
--rate-type sweep \
--warmup 0.01 \
--cooldown 0.01


ℹ Request Latency Statistics (Completed Requests)
|=============|=========|========|========|========|======|======|======|======|
| Benchmark   | Request Latency || TTFT           || ITL        || TPOT       ||
| Strategy    | Sec             || ms             || ms         || ms         ||
|             | Mdn     | p95    | Mdn    | p95    | Mdn  | p95  | Mdn  | p95  |
|-------------|---------|--------|--------|--------|------|------|------|------|
| synchronous | 7.1     | 7.8    | 50.0   | 51.1   | 6.9  | 7.6  | 6.9  | 7.6  |
| throughput  | 31.5    | 35.5   | 4195.4 | 4300.1 | 27.9 | 30.7 | 30.8 | 34.7 |
| constant    | 8.1     | 9.3    | 35.4   | 41.5   | 7.9  | 9.1  | 7.9  | 9.1  |
| constant    | 9.4     | 10.5   | 38.7   | 44.7   | 9.2  | 10.2 | 9.2  | 10.2 |
| constant    | 9.7     | 11.1   | 39.7   | 46.1   | 9.5  | 10.8 | 9.5  | 10.9 |
| constant    | 10.7    | 12.3   | 41.9   | 48.9   | 10.4 | 12.0 | 10.4 | 12.0 |
| constant    | 10.9    | 13.1   | 43.9   | 51.6   | 10.6 | 12.8 | 10.6 | 12.8 |
| constant    | 15.5    | 19.3   | 57.3   | 1123.4 | 14.9 | 18.4 | 15.1 | 18.8 |
| constant    | 14.5    | 17.5   | 55.3   | 615.3  | 14.1 | 17.1 | 14.2 | 17.1 |
| constant    | 13.6    | 17.9   | 53.8   | 118.7  | 13.2 | 17.4 | 13.3 | 17.4 |
|=============|=========|========|========|========|======|======|======|======|


ℹ Server Throughput Statistics
|=============|=====|======|=======|=======|=========|=========|========|========|========|=========|
| Benchmark   | Requests                |||| Input Tokens     || Output Tokens  || Total Tokens    ||
| Strategy    | Per Sec   || Concurrency  || Per Sec          || Per Sec        || Per Sec         ||
|             | Mdn | Mean | Mdn   | Mean  | Mdn     | Mean    | Mdn    | Mean   | Mdn    | Mean    |
|-------------|-----|------|-------|-------|---------|---------|--------|--------|--------|---------|
| synchronous | 0.1 | 0.2  | 1.0   | 1.0   | 150.4   | 156.5   | 141.8  | 154.9  | 142.2  | 311.0   |
| throughput  | 2.6 | 7.6  | 290.0 | 253.6 | 36427.2 | 71989.3 | 6534.4 | 8580.0 | 6581.3 | 17227.0 |
| constant    | 0.9 | 1.1  | 8.0   | 8.3   | 1119.5  | 1124.2  | 828.6  | 1078.3 | 829.5  | 2165.0  |
| constant    | 1.5 | 2.0  | 17.0  | 17.4  | 2083.0  | 2051.2  | 1471.5 | 1891.7 | 1473.3 | 3798.2  |
| constant    | 2.4 | 2.9  | 27.0  | 26.9  | 3045.7  | 3015.3  | 2107.8 | 2719.6 | 2110.9 | 5460.5  |
| constant    | 2.9 | 3.9  | 39.0  | 39.4  | 4007.1  | 3908.6  | 2653.6 | 3392.8 | 2658.2 | 6812.0  |
| constant    | 3.5 | 4.5  | 51.0  | 49.2  | 4968.1  | 4973.1  | 3282.3 | 4242.6 | 3287.9 | 8518.4  |
| constant    | 5.6 | 7.6  | 85.0  | 85.8  | 5931.8  | 7141.2  | 4235.3 | 5477.5 | 4249.2 | 10997.8 |
| constant    | 4.6 | 5.7  | 96.0  | 87.2  | 6887.1  | 8017.8  | 4727.7 | 6020.5 | 4736.9 | 12088.0 |
| constant    | 4.0 | 5.7  | 92.0  | 84.1  | 7843.8  | 8289.4  | 4694.8 | 6058.9 | 4704.7 | 12165.1 |
|=============|=====|======|=======|=======|=========|=========|========|========|========|=========|


# Guidellm Client (Decode-heavy)
guidellm benchmark --target http://localhost:8000 --model "Qwen/Qwen3-8B-FP8" \
--data 'prompt_tokens=128,output_tokens=2048' \
--data-samples 300 \
--rate-type sweep \
--warmup 0.01 \
--cooldown 0.01

ℹ Request Latency Statistics (Completed Requests)
|=============|=========|========|========|========|======|======|======|======|
| Benchmark   | Request Latency || TTFT           || ITL        || TPOT       ||
| Strategy    | Sec             || ms             || ms         || ms         ||
|             | Mdn     | p95    | Mdn    | p95    | Mdn  | p95  | Mdn  | p95  |
|-------------|---------|--------|--------|--------|------|------|------|------|
| synchronous | 11.0    | 14.0   | 28.0   | 28.8   | 5.3  | 6.8  | 5.3  | 6.8  |
| throughput  | 49.7    | 58.3   | 4180.1 | 4233.4 | 22.5 | 26.8 | 24.3 | 28.5 |
| constant    | 12.7    | 16.9   | 33.9   | 39.6   | 6.2  | 8.2  | 6.2  | 8.2  |
| constant    | 13.6    | 18.4   | 36.2   | 41.3   | 6.6  | 9.0  | 6.6  | 9.0  |
| constant    | 14.6    | 19.7   | 36.7   | 43.3   | 7.1  | 9.6  | 7.1  | 9.6  |
| constant    | 15.7    | 21.1   | 38.9   | 46.1   | 7.6  | 10.3 | 7.7  | 10.3 |
| constant    | 27.4    | 39.8   | 77.2   | 1770.1 | 12.7 | 19.1 | 13.4 | 19.4 |
| constant    | 19.3    | 26.9   | 44.8   | 54.7   | 9.4  | 13.1 | 9.4  | 13.1 |
| constant    | 20.5    | 28.3   | 46.6   | 58.5   | 10.0 | 13.8 | 10.0 | 13.8 |
| constant    | 22.2    | 31.5   | 49.4   | 65.3   | 10.8 | 15.3 | 10.8 | 15.4 |
|=============|=========|========|========|========|======|======|======|======|


ℹ Server Throughput Statistics
|=============|=====|======|=======|=======|========|========|========|=========|========|=========|
| Benchmark   | Requests                |||| Input Tokens   || Output Tokens   || Total Tokens    ||
| Strategy    | Per Sec   || Concurrency  || Per Sec        || Per Sec         || Per Sec         ||
|             | Mdn | Mean | Mdn   | Mean  | Mdn    | Mean   | Mdn    | Mean    | Mdn    | Mean    |
|-------------|-----|------|-------|-------|--------|--------|--------|---------|--------|---------|
| synchronous | 0.1 | 0.1  | 1.0   | 1.0   | 12.2   | 12.6   | 181.0  | 188.4   | 181.1  | 200.9   |
| throughput  | 1.9 | 5.0  | 288.0 | 240.5 | 4849.6 | 9658.8 | 7857.2 | 10338.6 | 7887.3 | 11025.2 |
| constant    | 0.6 | 0.7  | 9.0   | 8.7   | 96.0   | 97.8   | 1103.8 | 1426.4  | 1104.6 | 1521.1  |
| constant    | 0.9 | 1.2  | 18.0  | 17.5  | 179.5  | 180.1  | 1978.0 | 2557.3  | 1980.0 | 2727.1  |
| constant    | 1.4 | 1.8  | 28.0  | 26.3  | 263.1  | 266.1  | 2807.2 | 3627.8  | 2810.0 | 3868.7  |
| constant    | 1.9 | 2.5  | 40.0  | 38.1  | 346.7  | 345.4  | 3610.3 | 4662.8  | 3615.1 | 4972.5  |
| constant    | 3.9 | 5.6  | 92.0  | 102.7 | 430.9  | 755.7  | 6318.6 | 8260.4  | 6335.9 | 8809.0  |
| constant    | 2.5 | 3.4  | 71.0  | 64.0  | 513.2  | 508.3  | 4682.7 | 6077.9  | 4690.2 | 6481.5  |
| constant    | 2.8 | 3.8  | 83.0  | 76.4  | 596.6  | 594.9  | 5245.7 | 6813.6  | 5254.7 | 7266.1  |
| constant    | 3.2 | 4.3  | 102.0 | 91.8  | 679.2  | 677.9  | 5532.7 | 7215.6  | 5544.0 | 7694.8  |
|=============|=====|======|=======|=======|========|========|========|=========|========|=========|